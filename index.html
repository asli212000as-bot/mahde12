<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ù…ØªØ¬Ø± Ø§Ù„ÙˆØ±Ø¯ Ø§Ù„ÙØ§Ø®Ø±</title>
<link rel="stylesheet" href="styles.css">
</head>
<body>

<header>
  <div class="header-title">ğŸŒ¸ Ù…ØªØ¬Ø± Ø§Ù„ÙˆØ±Ø¯ Ø§Ù„ÙØ§Ø®Ø±</div>
</header>

<div class="container">

  <!-- Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø£Ù‚Ø³Ø§Ù… -->
  <div class="flex" style="justify-content:center;gap:12px;margin:20px 0">
    <button class="btn section-btn" data-target="ready-section">ğŸ’ Ø§Ù„Ø¨Ø§Ù‚Ø§Øª Ø§Ù„Ù…ØªÙˆÙØ±Ø©</button>
    <button class="btn section-btn" data-target="custom-section">ğŸ ØªØ®ØµÙŠØµ Ø¨Ø§Ù‚Ø©</button>
    <button class="btn section-btn" data-target="cs-section">ğŸ“ Ø®Ø¯Ù…Ø© Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡</button>
  </div>

  <!-- Ù‚Ø³Ù… Ø§Ù„Ø¨Ø§Ù‚Ø§Øª Ø§Ù„Ù…ØªÙˆÙØ±Ø© -->
  <div id="ready-section" class="section">
    <h2>Ø§Ù„Ø¨Ø§Ù‚Ø§Øª Ø§Ù„Ø¬Ø§Ù‡Ø²Ø©</h2>
    <div id="ready-bouquets" class="grid"></div>
  </div>

  <!-- Ù‚Ø³Ù… ØªØ®ØµÙŠØµ Ø¨Ø§Ù‚Ø© Ù…Ø®ØµØµØ© -->
  <div id="custom-section" class="section" style="display:none">
    <h2>ØªØ®ØµÙŠØµ Ø¨Ø§Ù‚Ø© Ù…Ø®ØµØµØ©</h2>
    <div class="card">
      <div class="form-row"><label>Ø§Ø®ØªÙØ± Ø¨Ø§Ù‚Ø© Ø£Ø³Ø§Ø³ÙŠØ©</label>
        <select id="baseSelect"></select>
      </div>
      <div class="form-row"><label>Ø¹Ø¯Ø¯ Ø§Ù„ÙˆØ±ÙˆØ¯</label><input type="number" id="qty" min="1" value="10"></div>
      <div class="form-row"><label>Ù„ÙˆÙ† Ø§Ù„ÙˆØ±Ø¯</label><select id="colorSelect"></select></div>
      <div class="form-row"><label>Ù†ÙˆØ¹ Ø§Ù„ØªØºÙ„ÙŠÙ</label><select id="packSelect"></select></div>
      <div class="form-row"><label>Ø§Ø³Ù… Ø§Ù„Ù…Ø±Ø³Ù„</label><input type="text" id="custName"></div>
      <div class="form-row"><label>Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</label><input type="text" id="custPhone"></div>

      <div class="flex" style="justify-content:flex-end;gap:8px;margin-top:8px">
        <button class="btn" id="calcBtn">Ø­Ø³Ø§Ø¨ Ø§Ù„Ø³Ø¹Ø± ÙˆØ¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨</button>
        <button class="btn ghost" id="previewPrice">Ø¹Ø±Ø¶ Ø§Ù„Ø³Ø¹Ø± ÙÙ‚Ø·</button>
      </div>

      <div class="card" style="margin-top:12px">
        <h3>Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„Ø³Ø¹Ø±</h3>
        <div class="small">Ø³Ø¹Ø± Ø§Ù„ÙˆØ±Ø¯Ø© Ø§Ù„Ø­Ø§Ù„ÙŠ: <span id="flowerPrice">-</span> Ø¯.Ø¹</div>
        <div class="small">Ø³Ø¹Ø± Ø§Ù„ØªØºÙ„ÙŠÙ Ø§Ù„Ù…Ø®ØªØ§Ø±: <span id="packPrice">-</span> Ø¯.Ø¹</div>
        <div style="margin-top:12px;font-size:20px;font-weight:800;color:var(--accent)">Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹: <span id="totalPrice">0</span> Ø¯.Ø¹</div>
      </div>
    </div>
  </div>

  <!-- Ù‚Ø³Ù… Ø®Ø¯Ù…Ø© Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ -->
  <div id="cs-section" class="section" style="display:none">
    <h2>Ø®Ø¯Ù…Ø© Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡</h2>
    <form id="csForm" class="card cs-form">
      <div class="form-row"><label>Ø§Ø³Ù…Ùƒ</label><input type="text" id="csName" required></div>
      <div class="form-row"><label>Ø§Ø³ØªÙØ³Ø§Ø±Ùƒ</label><textarea id="csMsg" required></textarea></div>
      <div style="text-align:left;margin-top:10px"><button class="btn" type="submit">Ø¥Ø±Ø³Ø§Ù„</button></div>
    </form>
  </div>

  <div class="footer">Â© 2025 Ù…ØªØ¬Ø± Ø§Ù„ÙˆØ±Ø¯ â€” Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©</div>
</div>

<script>
// Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ù‚Ø³Ø§Ù…
document.querySelectorAll('.section-btn').forEach(btn=>{
  btn.addEventListener('click', ()=>{
    document.querySelectorAll('.section').forEach(sec=>sec.style.display='none');
    document.getElementById(btn.dataset.target).style.display='block';
  });
});

/* Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø­Ù„ÙŠØ© */
function getState(key, fallback){ try{ return JSON.parse(localStorage.getItem(key))||fallback;}catch(e){return fallback;} }
function setState(key,val){ localStorage.setItem(key,JSON.stringify(val)); }

const bouquets = getState('bouquets', []);
const settings = getState('settings', {flowerPrice:50,packs:[{name:'ØµÙ†Ø¯ÙˆÙ‚',price:10},{name:'Ø³Ù„Ø©',price:7}],colors:['Ø£Ø­Ù…Ø±','Ø£Ø¨ÙŠØ¶','ÙˆØ±Ø¯ÙŠ']});

const readyBouquetsEl = document.getElementById('ready-bouquets');
const baseSelect = document.getElementById('baseSelect');
const colorSelect = document.getElementById('colorSelect');
const packSelect = document.getElementById('packSelect');
const flowerPriceEl = document.getElementById('flowerPrice');
const packPriceEl = document.getElementById('packPrice');
const totalPriceEl = document.getElementById('totalPrice');
const qtyEl = document.getElementById('qty');

// Ø¹Ø±Ø¶ Ø§Ù„Ø¨Ø§Ù‚Ø§Øª Ø§Ù„Ø¬Ø§Ù‡Ø²Ø©
function renderReadyBouquets(){
  readyBouquetsEl.innerHTML='';
  if(!bouquets.length){ readyBouquetsEl.innerHTML='<div class="small">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨Ø§Ù‚Ø§Øª Ø­Ø§Ù„ÙŠØ§Ù‹</div>'; return; }
  bouquets.forEach(b=>{
    const d = document.createElement('div');
    d.className='bouquet-card card';
    d.style.padding='8px';
    d.innerHTML = `
      <div style="width:150px;height:150px;overflow:hidden;margin:0 auto;border-radius:12px">
        <img src="${b.image}" alt="${b.name}" style="width:100%;height:100%;object-fit:cover;">
      </div>
      <h3 style="text-align:center;margin-top:8px">${b.name}</h3>
      <p class="small" style="text-align:center">${b.description||''}</p>
      <div class="price" style="text-align:center">${b.price} Ø¯.Ø¹</div>
    `;
    readyBouquetsEl.appendChild(d);
  });
}

// Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù…Ø­Ø¯Ø¯Ø§Øª
function buildSelectors(){
  baseSelect.innerHTML='<option value="">-- Ø§Ø®ØªØ± Ø¨Ø§Ù‚Ø© --</option>';
  bouquets.forEach((b,i)=> baseSelect.innerHTML += `<option value="${i}">${b.name} (${b.price} Ø¯.Ø¹)</option>`);
  colorSelect.innerHTML='';
  settings.colors.forEach(c=> colorSelect.innerHTML += `<option value="${c}">${c}</option>`);
  packSelect.innerHTML='';
  settings.packs.forEach((p,idx)=> packSelect.innerHTML += `<option value="${idx}">${p.name} (+${p.price} Ø¯.Ø¹)</option>`);
  flowerPriceEl.textContent=settings.flowerPrice;
}

// Ø­Ø³Ø§Ø¨ Ø§Ù„Ø³Ø¹Ø±
function updatePrice(){
  const baseIdx = baseSelect.value;
  const qty = Number(qtyEl.value)||0;
  const flowerPrice = Number(settings.flowerPrice)||0;
  const packIdx = Number(packSelect.value);
  const packPrice = (settings.packs[packIdx] && settings.packs[packIdx].price) ? Number(settings.packs[packIdx].price) : 0;
  const total = Math.round(qty*flowerPrice + packPrice);
  flowerPriceEl.textContent=flowerPrice;
  packPriceEl.textContent=packPrice;
  totalPriceEl.textContent=total;
  return total;
}

document.getElementById('previewPrice').addEventListener('click',()=>alert('Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: '+updatePrice()+' Ø¯.Ø¹'));

document.getElementById('calcBtn').addEventListener('click',()=>{
  const baseIdx = baseSelect.value;
  if(baseIdx==='') return alert('Ø§Ø®ØªØ± Ø¨Ø§Ù‚Ø© Ø£Ø³Ø§Ø³ÙŠØ©');
  const qty = Number(qtyEl.value)||0;
  if(qty<=0) return alert('Ø£Ø¯Ø®Ù„ Ø¹Ø¯Ø¯ Ø§Ù„ÙˆØ±ÙˆØ¯');
  const name = document.getElementById('custName').value.trim();
  const phone = document.getElementById('custPhone').value.trim();
  if(!name||!phone) return alert('Ø£Ø¯Ø®Ù„ Ø§Ù„Ø§Ø³Ù… ÙˆØ±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ');
  
  const packIdx = Number(packSelect.value);
  const packName = settings.packs[packIdx].name||'';
  const packPrice = Number(settings.packs[packIdx].price)||0;
  const flowerPrice = Number(settings.flowerPrice)||0;
  const total = Math.round(qty*flowerPrice + packPrice);

  const order={pkgName:bouquets[baseIdx].name,qty,color:colorSelect.value,pack:packName,price:total,name,phone,status:'new',created:Date.now()};
  const orders = getState('orders',[]);
  orders.unshift(order);
  setState('orders',orders);
  alert('ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨. Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹: '+total+' Ø¯.Ø¹');
  document.getElementById('custName').value='';
  document.getElementById('custPhone').value='';
});

document.getElementById('csForm').addEventListener('submit',e=>{
  e.preventDefault();
  const n=document.getElementById('csName').value.trim();
  const m=document.getElementById('csMsg').value.trim();
  if(!n||!m) return alert('Ø§Ù…Ù„Ø£ Ø§Ù„Ø­Ù‚ÙˆÙ„');
  const cs=getState('cs',[]);
  cs.unshift({name:n,msg:m,time:Date.now()});
  setState('cs',cs);
  alert('ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ø³Ø§Ù„Ø©.');
  e.target.reset();
});

qtyEl.addEventListener('input',updatePrice);
packSelect.addEventListener('change',updatePrice);
baseSelect.addEventListener('change',updatePrice);

renderReadyBouquets();
buildSelectors();
updatePrice();
</script>

</body>
</html>

